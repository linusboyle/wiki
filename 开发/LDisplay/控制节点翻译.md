# 控制节点翻译

把等式左边和右边的元变量分别变成控制节点的参数和返回值。在这一过程中，要检查元变量访问的目标是否存在、目标是否是widget的参数和事件，如果没问题，要得到变量的类型（和时钟？）。

这一过程看似比较简单，但是需要创建一系列环境。首先我们可以修改DisplayW，直接传入widgetenv（控件名到widgetT的树），这样就不用再创建一次。然后我们需要把mega对应到分配的id上。在分配过程中进行传入we检查。

怎么建立mega到id的映射？mega由两个正整数组成，要用compcert的映射表结构的话，必须实现一个N * N -> N的双射。这一点在数学上不难，就是用coq写出来不太容易。为了简单，就用list好了，效率低一点也没什么。

更新：我把映射的部分放到了MarkUp里，把映射的值变成了类型参数。这样能稍微重用一下代码